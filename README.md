Тестовое задание

Задание 2

Задание 2.1

Объяснение решения
Чтобы нормализовать таблицу «orders», необходимо создать несколько дополнительных таблиц и изменить колонки текущей таблицы. Это позволит уменьшить размер таблицы, облегчив работу с ней (добавление новых заказов, получение информации о заказе), уменьшив вероятность дублирования данных – в таблице с большим количеством колонок такая вероятность выше.
Было принято решение разделить информацию о заказе и категориях билета, а также создать отдельную таблицу для билетов в заказах, чтобы одна таблица не содержала большое количество несогласованных зависимостей и изменения в одной колонке таблицы не приводили к необходимости изменять всю таблицу целиком.

В качестве альтернативы выбранному решению можно было бы удалить из таблицы «orders» колонки «ticket_adult_price», «ticket_adult_quantity», «ticket_kid_price», «ticket_kid_quantity», «barcode» и хранить информацию о билетах в отдельной колонке таблицы «orders» в виде JSON, содержащего данные о типе билета, его цене, количестве и штрих-коды к каждому билету. Но поскольку это усложнит запросы и обработку данных, а также не соответствует идее хранения одного типа данных в одном поле таблицы, было решено создать несколько дополнительных таблиц и изменить исходную таблицу:

Новая версия таблицы «orders»
Хранит основную информацию о заказах, такую как идентификатор заказа, идентификатор мероприятия, дату мероприятия, штрих-код, идентификатор пользователя, общую стоимость и время создания заказа.

CREATE TABLE orders (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    event_id VARCHAR(255) NOT NULL,
    event_date DATETIME NOT NULL,
    user_id VARCHAR(255) NOT NULL,
    barcode VARCHAR(255) NOT NULL,
    equal_price INT NOT NULL,
    created DATETIME NOT NULL
);


Таблица «ticket_types»
Хранит информацию о типах билетов (взрослый, детский, льготный, групповой, возможно также добавление новых типов в будущем) и их ценах.

CREATE TABLE ticket_types (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    type_name VARCHAR(50) NOT NULL UNIQUE,
    price INT NOT NULL
);


Таблица «order_tickets»
Связывает заказы с типами билетов и хранит количество каждого типа билетов в заказе.

CREATE TABLE order_tickets (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    order_id INT NOT NULL,
    ticket_type_id INT NOT NULL,
    quantity INT NOT NULL,
    FOREIGN KEY (order_id) REFERENCES orders(id),
    FOREIGN KEY (ticket_type_id) REFERENCES ticket_types(id)
);
 
Задание 2.2

Объяснение решения
Как и в прошлом задании, для реализации возможности хранения штрих-кодов, число которых соответствовало бы числу билетов, необходимо создать новую таблицу и изменить таблицу «orders». Это позволит легко добавлять новые штрих-коды к каждому билету и извлекать данные. Также возможно было бы хранить данные о штрих-кодах в отдельной колонке таблицы «order_tickets», но такой подход усложнил бы работу с таблицей. Поэтому было принято решение убрать из таблицы «orders» колонку «barcode» и создать новую таблицу «barcodes».


Новая версия таблицы «orders»
Хранит основную информацию о заказах, такую как идентификатор заказа, идентификатор мероприятия, дату мероприятия, идентификатор пользователя, общую стоимость и время создания заказа.

CREATE TABLE orders (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    event_id VARCHAR(255) NOT NULL,
    event_date DATETIME NOT NULL,
    user_id VARCHAR(255) NOT NULL,
    equal_price INT NOT NULL,
    created DATETIME NOT NULL
);


Таблица «barcodes»
Хранит штрих-коды для каждого билета в заказе.

CREATE TABLE barcodes (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    order_ticket_id INT NOT NULL,
    barcode VARCHAR(255) NOT NULL,
    FOREIGN KEY (order_ticket_id) REFERENCES order_tickets(id)
);

 
Задание 3

Документация

Документация доступна в самом файле.
